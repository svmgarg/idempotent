<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Idempotency Service - API Documentation</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='0.9em' font-size='90'>ðŸ”’</text></svg>">
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <!-- Sidebar Navigation -->
    <aside class="sidebar" id="sidebar">
        <div class="sidebar-header">
            <a class="logo" href="#">Idempotency Service</a>
            <button class="sidebar-toggle d-lg-none" id="sidebarToggle" title="Close">
                <span></span>
                <span></span>
                <span></span>
            </button>
        </div>
        <nav class="sidebar-nav">
            <h5 class="nav-section-title">Documentation</h5>
            <ul class="nav-list">
                <li><a href="#overview" class="nav-link-sidebar">Overview</a></li>
                <li><a href="#quickstart" class="nav-link-sidebar">Quick Start</a></li>
                <li><a href="#use-cases" class="nav-link-sidebar">Use Cases</a></li>
            </ul>

            <h5 class="nav-section-title">Integration</h5>
            <ul class="nav-list">
                <li><a href="#authentication" class="nav-link-sidebar">Authentication</a></li>
                <li><a href="#check-api" class="nav-link-sidebar">Check API</a></li>
                <li><a href="#health-api" class="nav-link-sidebar">Health API</a></li>
            </ul>

            <h5 class="nav-section-title">Resources</h5>
            <ul class="nav-list">
                <li><a href="#examples" class="nav-link-sidebar">Examples</a></li>
                <li><a href="#tester" class="nav-link-sidebar">API Tester</a></li>
                <li><a href="#faq" class="nav-link-sidebar">FAQ</a></li>
            </ul>
        </nav>
    </aside>

    <!-- Main Content -->
    <main class="main-content">
        <!-- Content Area (SPA - One section at a time) -->
        <div class="content-area">
            <!-- Overview Section -->
            <section class="page" data-page="overview">
                <h2>Overview</h2>
                <p>The Idempotency Service is your safety net against duplicate triggers.</p>
                <p>In distributed systems, the same request can arrive multiple times due to network failures, user retries, automation tool retries, or client-side issues. Without idempotency, this means the same operation gets executed multiple timesâ€”resulting in duplicate charges, double-booked seats, duplicate orders, or duplicate notifications.</p>
                
                <div class="info-box">
                    <strong>How It Works:</strong>
                    <ol style="margin-top: 10px;">
                        <li><strong>First Request:</strong> Your app calls <code>/check</code> with a unique ID â†’ Returns <code>isDuplicate: false</code></li>
                        <li><strong>Process:</strong> Your app executes the operation (payment, order, etc.) and caches the result</li>
                        <li><strong>Duplicate Request:</strong> Same ID arrives again â†’ Calls <code>/check</code> â†’ Returns <code>isDuplicate: true</code></li>
                        <li><strong>Skip:</strong> Your app returns the cached result WITHOUT re-executing</li>
                    </ol>
                </div>

                <h3>Base URL</h3>
                <pre><code>http://144.24.119.46/api/idempotency</code></pre>
            </section>

            <!-- Quick Start Section -->
            <section class="page" data-page="quickstart">
                <h2>Quick Start</h2>
                <p>Get up and running with the Idempotency Service in just a few steps:</p>

                <div class="success-box">
                    <strong>Step 1: Check the Service is Healthy</strong>
                    <pre style="margin-top: 10px;"><code>curl http://144.24.119.46/ping</code></pre>
                    <p style="margin-top: 10px; margin-bottom: 0;">Expected response: <code>PONG</code></p>
                </div>

                <div class="success-box">
                    <strong>Step 2: Make Your First Idempotency Check</strong>
                    <pre style="margin-top: 10px;"><code>curl -X POST http://144.24.119.46/api/idempotency/check \
  -H "Content-Type: application/json" \
  -H "X-API-KEY: demo-key-123" \
  -d '{"idempotencyKey": "order-001", "ttlSeconds": 3600}'</code></pre>
                </div>

                <div class="success-box">
                    <strong>Step 3: Test Duplicate Detection</strong>
                    <p>Run the same curl command again â†’ You should get <code>"isDuplicate": true</code></p>
                </div>

                <h3>Integration Pattern</h3>
                <p><strong>For your application:</strong></p>
                <ol>
                    <li>Generate a unique key (UUID, order-ID, etc.)</li>
                    <li>Call <code>/api/idempotency/check</code> with your key</li>
                    <li>If <code>isDuplicate: false</code> â†’ execute your operation</li>
                    <li>If <code>isDuplicate: true</code> â†’ return cached result</li>
                </ol>
            </section>
            <section class="page" data-page="use-cases">
                <h2>Real-World Scenarios</h2>
                <p>Here are common situations where duplicate triggers occur and how this service helps:</p>

                <div class="endpoint">
                    <h3>Order Creation (Most Common)</h3>
                    <p><strong>Scenario:</strong> A user clicks "Place Order" twice or the client retries due to a timeout.</p>
                    <p><strong>Without idempotency:</strong> Two orders can be created, customer may be charged twice.</p>
                    <p><strong>With idempotency:</strong> Only the first request is processed and all retries return the same response.</p>
                </div>

                <div class="endpoint">
                    <h3>Payment Capture / Payment Processing</h3>
                    <p><strong>Scenario:</strong> Payment API is retried due to double click or client retry for an order.</p>
                    <p><strong>Without idempotency:</strong> Payment can be captured multiple times.</p>
                    <p><strong>With idempotency:</strong> Payment is executed only once and retries return the original payment result.</p>
                </div>

                <div class="endpoint">
                    <h3>Inventory Reservation / Stock Deduction</h3>
                    <p><strong>Scenario:</strong> Inventory reserve/deduct call is retried due to application crash or client retry.</p>
                    <p><strong>Without idempotency:</strong> Stock may be reduced multiple times causing incorrect inventory.</p>
                    <p><strong>With idempotency:</strong> Stock is deducted only once.</p>
                </div>

                <div class="endpoint">
                    <h3>Webhook Processing (Stripe / Razorpay / PayPal / Zapier)</h3>
                    <p><strong>Scenario:</strong> Webhook providers retry the same webhook event multiple times.</p>
                    <p><strong>Without idempotency:</strong> Duplicate invoice generation / duplicate order update / duplicate notifications.</p>
                    <p><strong>With idempotency:</strong> Use webhook eventId as key and process each event exactly once.</p>
                </div>

                <div class="endpoint">
                    <h3>Invoice Generation / Document Generation</h3>
                    <p><strong>Scenario:</strong> Invoice generation is retried due to failure or retry policy.</p>
                    <p><strong>Without idempotency:</strong> Multiple invoices can be created for the same order.</p>
                    <p><strong>With idempotency:</strong> Invoice is generated only once.</p>
                </div>

                <div class="endpoint">
                    <h3>Notification / Email / SMS Sending</h3>
                    <p><strong>Scenario:</strong> Notification send is retried due to network issues.</p>
                    <p><strong>Without idempotency:</strong> User receives duplicate emails/SMS.</p>
                    <p><strong>With idempotency:</strong> Only one notification is sent per unique key.</p>
                </div>

                <div class="endpoint">
                    <h3>Zapier Integration (Automation Safety)</h3>
                    <p><strong>Scenario:</strong> Zapier workflows may trigger twice or retry because of network failures / step failures / replay.</p>
                    <p><strong>Without idempotency:</strong> Duplicate CRM updates, duplicate Slack messages, duplicate payments.</p>
                    <p><strong>With idempotency:</strong> Zapier sends a stable idempotency key and your service blocks duplicate execution.</p>
                </div>
            </section>

            <!-- Authentication Section -->
            <section class="page" data-page="authentication">
                <h2>Authentication</h2>
                <p>The <code>/check</code> endpoint requires API Key authentication. Include the API key in the request header.</p>

                <h3>How to Get an API Key</h3>
                <p><strong>Request API Key:</strong> To obtain an API key, please send a request email to: <a href="mailto:svmgarg@gmail.com?subject=API%20Key%20Request%20for%20Idempotency%20Service&body=Hi,%0A%0AI%20would%20like%20to%20request%20an%20API%20key%20for%20the%20Idempotency%20Service.%0A%0AThank%20you">svmgarg@gmail.com</a></p>
                <p>In your email, please mention:</p>
                <ul>
                    <li>Your name or organization</li>
                    <li>Use case for the API</li>
                    <li>Expected request volume</li>
                </ul>

                <h3>Header</h3>
                <div class="table-responsive">
                    <table class="table table-hover">
                        <thead>
                            <tr>
                                <th>Header Name</th>
                                <th>Value</th>
                                <th>Required</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><code>X-API-KEY</code></td>
                                <td>Your assigned API key (provided by administrator)</td>
                                <td><span class="badge bg-danger">Required</span></td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <div class="warning-box">
                    <strong>Important:</strong> The <code>/ping</code> endpoint does not require authentication. All other endpoints require API Key authentication.
                </div>
            </section>

            <!-- Check API Section -->
            <section class="page" data-page="check-api">
                <h2>Check API</h2>

                <div class="endpoint">
                    <h3 style="margin-top: 0;">
                        <span class="method post">POST</span>
                        <code>/api/idempotency/check</code>
                        <span class="badge bg-danger ms-2">Auth Required</span>
                    </h3>
                    <p>Atomically checks if an idempotency key exists and inserts it if not found.</p>

                    <h4>Request Body</h4>
                    <div class="table-responsive">
                        <table class="table table-hover table-sm">
                            <thead>
                                <tr>
                                    <th>Field</th>
                                    <th>Type</th>
                                    <th>Required</th>
                                    <th>Description</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><code>idempotencyKey</code></td>
                                    <td>string</td>
                                    <td><span class="badge bg-danger">Required</span></td>
                                    <td>Unique key to identify the operation | Max 64 characters</td>
                                </tr>
                                <tr>
                                    <td><code>clientId</code></td>
                                    <td>string</td>
                                    <td><span class="badge bg-secondary">Optional</span></td>
                                    <td>Client identifier for multi-tenant scenarios | Max 64 characters</td>
                                </tr>
                                <tr>
                                    <td><code>ttlSeconds</code></td>
                                    <td>long</td>
                                    <td><span class="badge bg-secondary">Optional</span></td>
                                    <td>Custom TTL in seconds (overrides default 3600s) | Max 3600 seconds (1 hour)</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <div class="info-box">
                        <strong>Validation Rules:</strong>
                        <ul style="margin-top: 10px; margin-bottom: 0;">
                            <li><code>idempotencyKey</code>: Must be between 1-64 characters. Use meaningful, unique identifiers (Payment ID, Order ID, etc.)</li>
                            <li><code>ttlSeconds</code>: Maximum 3600 seconds (1 hour). Default is 3600s if not specified. This limits how long we remember processed operations.</li>
                            <li>If you need longer memory windows, contact support for enterprise plans.</li>
                        </ul>
                    </div>

                    <h4>Example Request</h4>
                    <pre><code>POST /api/idempotency/check
Content-Type: application/json
X-API-KEY: your-api-key-here

{
  "idempotencyKey": "payment-123",
  "ttlSeconds": 3600
}</code></pre>

                    <h4>Example Response (New Key)</h4>
                    <pre><code>{
  "idempotencyKey": "payment-123",
  "isDuplicate": false,
  "createdAt": "2026-02-07T12:00:00Z",
  "expiresAt": "2026-02-07T13:00:00Z",
  "processingTimeNanos": 12500
}</code></pre>

                    <h4>Response Codes</h4>
                    <p><strong>200 OK</strong> All responses return 200 OK (check <code>resultStatusCode</code> in body for actual status)</p>

                    <div class="info-box">
                        <strong>Important Behavior (Zapier Compatible):</strong>
                        <ul style="margin-top: 10px; margin-bottom: 0;">
                            <li><strong>HTTP Status:</strong> Always <code>200 OK</code> for all responses (success, validation error, server error)</li>
                            <li><strong>Actual Status:</strong> Check the <code>resultStatusCode</code> field in the response body:
                                <ul>
                                    <li><code>200</code> = Successful check (new or duplicate)</li>
                                    <li><code>400</code> = Invalid request body or validation error</li>
                                    <li><code>401</code> = Missing or invalid API key</li>
                                    <li><code>500</code> = Server error occurred</li>
                                </ul>
                            </li>
                            <li><strong>Check <code>isDuplicate</code> field</strong> to determine if operation should proceed</li>
                            <li>If <code>isDuplicate</code> is <code>false</code>, proceed with your operation</li>
                            <li>If <code>isDuplicate</code> is <code>true</code>, skip the operation (already processed)</li>
                            <li>Expired keys are automatically replaced with new entries</li>
                        </ul>
                    </div>
                </div>
            </section>

            <!-- Health API Section -->
            <section class="page" data-page="health-api">
                <h2>Health & Monitoring</h2>

                <div class="endpoint">
                    <h3 style="margin-top: 0;">
                        <span class="method get">GET</span>
                        <code>/api/idempotency/health</code>
                    </h3>
                    <p>Health check endpoint - requires API key</p>
                </div>

                <div class="endpoint">
                    <h3 style="margin-top: 0;">
                        <span class="method get">GET</span>
                        <code>/ping</code>
                    </h3>
                    <p>Simple ping endpoint - no authentication needed</p>
                </div>
            </section>

            <!-- Examples Section -->
            <section class="page" data-page="examples">
                <h2>Code Examples</h2>

                <h3>cURL</h3>
                <div class="code-block">
                    <button class="btn btn-sm btn-outline-primary copy-btn" title="Copy to clipboard">ðŸ“‹ Copy</button>
                    <pre><code>curl -X POST http://144.24.119.46/api/idempotency/check \
  -H "Content-Type: application/json" \
  -H "X-API-KEY: your-api-key" \
  -d '{
    "idempotencyKey": "order-12345",
    "ttlSeconds": 3600
  }'</code></pre>
                </div>

                <h3>JavaScript</h3>
                <div class="code-block">
                    <button class="btn btn-sm btn-outline-primary copy-btn" title="Copy to clipboard">ðŸ“‹ Copy</button>
                    <pre><code>fetch('http://144.24.119.46/api/idempotency/check', {
  method: 'POST',
  headers: {
    'Content-Type': 'application/json',
    'X-API-KEY': 'your-api-key'
  },
  body: JSON.stringify({
    idempotencyKey: 'order-12345',
    ttlSeconds: 3600
  })
}).then(r => r.json()).then(data => {
  if (data.isDuplicate) {
    console.log('Duplicate - skip operation');
  } else {
    console.log('New request - proceed');
  }
});</code></pre>
                </div>

                <h3>Python</h3>
                <div class="code-block">
                    <button class="btn btn-sm btn-outline-primary copy-btn" title="Copy to clipboard">ðŸ“‹ Copy</button>
                    <pre><code>import requests

response = requests.post(
    'http://144.24.119.46/api/idempotency/check',
    headers={'X-API-KEY': 'your-api-key'},
    json={
        'idempotencyKey': 'order-12345',
        'ttlSeconds': 3600
    }
)

if response.json()['isDuplicate']:
    print('Duplicate - skip operation')
else:
    print('New request - proceed')</code></pre>
                </div>
            </section>

            <!-- API Tester Section -->
            <section class="page" data-page="tester">
                <h2>Interactive API Tester</h2>
                <p>Test the Idempotency Check API directly below:</p>

                <div class="endpoint">
                    <form id="testerForm" class="row g-3">
                        <div class="col-md-6">
                            <label for="apiKey" class="form-label"><strong>API Key</strong></label>
                            <input type="text" class="form-control" id="apiKey" placeholder="your-api-key" value="demo-key-123">
                        </div>
                        <div class="col-md-6">
                            <label for="idempotencyKey" class="form-label"><strong>Idempotency Key</strong></label>
                            <input type="text" class="form-control" id="idempotencyKey" placeholder="e.g., order-123" value="">
                        </div>
                        <div class="col-md-6">
                            <label for="ttlSeconds" class="form-label"><strong>TTL Seconds</strong></label>
                            <input type="number" class="form-control" id="ttlSeconds" placeholder="3600" value="3600" min="1" max="3600">
                        </div>
                        <div class="col-md-6 d-flex align-items-end">
                            <button type="button" class="btn btn-primary w-100" id="testBtn">ðŸš€ Test API</button>
                        </div>
                    </form>

                    <div id="testerResult" style="display: none; margin-top: 20px;">
                        <h4>Response:</h4>
                        <pre id="resultJson"><code>Waiting for response...</code></pre>
                        <button class="btn btn-sm btn-outline-secondary" id="copyResultBtn">ðŸ“‹ Copy Response</button>
                    </div>

                    <div id="testerError" style="display: none; margin-top: 20px;" class="alert alert-danger"></div>
                    <div id="testerLoading" style="display: none; margin-top: 20px;" class="alert alert-info">
                        <div class="spinner-border spinner-border-sm me-2" role="status">
                            <span class="visually-hidden">Loading...</span>
                        </div>
                        Testing API...
                    </div>
                </div>
            </section>

            <!-- FAQ Section -->
            <section class="page" data-page="faq">
                <h2>Frequently Asked Questions</h2>

                <div class="accordion" id="faqAccordion">
                    <div class="accordion-item">
                        <h2 class="accordion-header">
                            <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#faq1">
                                What happens if I don't call the service?
                            </button>
                        </h2>
                        <div id="faq1" class="accordion-collapse collapse show" data-bs-parent="#faqAccordion">
                            <div class="accordion-body">
                                Without idempotency checks, duplicate requests will execute your operation multiple times. This can result in duplicate charges, multiple orders, or repeated notifications.
                            </div>
                        </div>
                    </div>

                    <div class="accordion-item">
                        <h2 class="accordion-header">
                            <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#faq2">
                                How long should I set the TTL?
                            </button>
                        </h2>
                        <div id="faq2" class="accordion-collapse collapse" data-bs-parent="#faqAccordion">
                            <div class="accordion-body">
                                TTL (Time-To-Live) depends on your use case: 
                                <ul>
                                    <li><strong>Orders/Payments:</strong> 1-6 hours (3600-21600 seconds)</li>
                                    <li><strong>Quick operations:</strong> 5-10 minutes (300-600 seconds)</li>
                                    <li><strong>Webhooks:</strong> Match your webhook retry timeout (usually 24-48 hours)</li>
                                </ul>
                            </div>
                        </div>
                    </div>

                    <div class="accordion-item">
                        <h2 class="accordion-header">
                            <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#faq3">
                                What if the service is down?
                            </button>
                        </h2>
                        <div id="faq3" class="accordion-collapse collapse" data-bs-parent="#faqAccordion">
                            <div class="accordion-body">
                                If the service is unavailable, you should fail-safe by either:
                                <ul>
                                    <li>Retry your operation after service recovery</li>
                                    <li>Use local caching as a fallback</li>
                                    <li>Implement exponential backoff before retrying</li>
                                </ul>
                            </div>
                        </div>
                    </div>

                    <div class="accordion-item">
                        <h2 class="accordion-header">
                            <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#faq4">
                                Can I use any string as the idempotency key?
                            </button>
                        </h2>
                        <div id="faq4" class="accordion-collapse collapse" data-bs-parent="#faqAccordion">
                            <div class="accordion-body">
                                Yes, any string 1-64 characters long works. Best practices:
                                <ul>
                                    <li><code>UUID</code> - Best for uniqueness</li>
                                    <li><code>order-ID</code> - Descriptive</li>
                                    <li><code>user-123-action-456</code> - More context</li>
                                </ul>
                            </div>
                        </div>
                    </div>

                    <div class="accordion-item">
                        <h2 class="accordion-header">
                            <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#faq5">
                                What's the performance overhead?
                            </button>
                        </h2>
                        <div id="faq5" class="accordion-collapse collapse" data-bs-parent="#faqAccordion">
                            <div class="accordion-body">
                                Each check takes <strong>&lt;15ms</strong> on average:
                                <ul>
                                    <li>First request (new key): ~10-15ms</li>
                                    <li>Duplicate request (existing key): ~5-10ms</li>
                                    <li>Response includes processing time in nanoseconds for detailed metrics</li>
                                </ul>
                            </div>
                        </div>
                    </div>

                    <div class="accordion-item">
                        <h2 class="accordion-header">
                            <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#faq6">
                                How do I generate a good idempotency key?
                            </button>
                        </h2>
                        <div id="faq6" class="accordion-collapse collapse" data-bs-parent="#faqAccordion">
                            <div class="accordion-body">
                                Use a combination that uniquely identifies the operation:
                                <pre><code>// Good examples:
const key = `user-${userId}-order-${Date.now()}`;  // Descriptive + timestamp
const key = crypto.randomUUID();                     // Pure uniqueness
const key = `${userId}-${orderId}`;                 // User + order combo</code></pre>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
        </div>
    </div>
    </main>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // Copy to clipboard functionality
        document.querySelectorAll('.copy-btn').forEach(btn => {
            btn.addEventListener('click', function(e) {
                e.preventDefault();
                const codeBlock = this.nextElementSibling;
                const code = codeBlock.textContent;
                navigator.clipboard.writeText(code).then(() => {
                    const originalText = this.textContent;
                    this.textContent = 'âœ… Copied!';
                    this.classList.add('copied');
                    setTimeout(() => {
                        this.textContent = originalText;
                        this.classList.remove('copied');
                    }, 2000);
                }).catch(err => {
                    console.error('Failed to copy:', err);
                    this.textContent = 'âŒ Failed';
                    setTimeout(() => {
                        this.textContent = 'ðŸ“‹ Copy';
                    }, 2000);
                });
            });
        });

        // API Tester functionality
        document.getElementById('testBtn').addEventListener('click', async function() {
            const apiKey = document.getElementById('apiKey').value.trim();
            const idempotencyKey = document.getElementById('idempotencyKey').value.trim();
            const ttlSeconds = document.getElementById('ttlSeconds').value;

            const errorDiv = document.getElementById('testerError');
            const resultDiv = document.getElementById('testerResult');
            const loadingDiv = document.getElementById('testerLoading');

            errorDiv.style.display = 'none';
            resultDiv.style.display = 'none';
            loadingDiv.style.display = 'block';

            // Validation
            if (!apiKey) {
                errorDiv.textContent = 'âŒ API Key is required';
                errorDiv.style.display = 'block';
                loadingDiv.style.display = 'none';
                return;
            }
            if (!idempotencyKey) {
                errorDiv.textContent = 'âŒ Idempotency Key is required';
                errorDiv.style.display = 'block';
                loadingDiv.style.display = 'none';
                return;
            }

            try {
                const response = await fetch('http://144.24.119.46/api/idempotency/check', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'X-API-KEY': apiKey
                    },
                    body: JSON.stringify({
                        idempotencyKey: idempotencyKey,
                        ttlSeconds: parseInt(ttlSeconds) || 3600
                    })
                });

                const data = await response.json();
                
                if (!response.ok) {
                    errorDiv.textContent = `âŒ Error: ${data.message || data.error || 'Unknown error'}`;
                    errorDiv.style.display = 'block';
                } else {
                    document.getElementById('resultJson').textContent = JSON.stringify(data, null, 2);
                    resultDiv.style.display = 'block';
                }
            } catch (error) {
                errorDiv.textContent = `âŒ Connection Error: ${error.message}`;
                errorDiv.style.display = 'block';
            } finally {
                loadingDiv.style.display = 'none';
            }
        });

        // Copy result functionality
        document.getElementById('copyResultBtn').addEventListener('click', function() {
            const resultText = document.getElementById('resultJson').textContent;
            navigator.clipboard.writeText(resultText).then(() => {
                const originalText = this.textContent;
                this.textContent = 'âœ… Copied!';
                setTimeout(() => {
                    this.textContent = originalText;
                }, 2000);
            });
        });

        // Smooth scroll for nav links
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                const target = document.querySelector(this.getAttribute('href'));
                if (target) {
                    target.scrollIntoView({ behavior: 'smooth' });
                }
            });
        });

        // SPA Page Navigation
        document.querySelectorAll('.nav-link-sidebar').forEach(link => {
            link.addEventListener('click', function(e) {
                e.preventDefault();
                const pageId = this.getAttribute('href').substring(1);
                showPage(pageId);
                
                // Close sidebar on mobile
                if (window.innerWidth < 992) {
                    document.getElementById('sidebar').classList.remove('active');
                }
            });
        });

        function showPage(pageId) {
            // Hide all pages
            document.querySelectorAll('.page').forEach(page => {
                page.classList.remove('active');
            });
            
            // Show selected page
            const activePage = document.querySelector(`[data-page="${pageId}"]`);
            if (activePage) {
                activePage.classList.add('active');
            }
            
            // Update active nav link
            document.querySelectorAll('.nav-link-sidebar').forEach(navLink => {
                navLink.classList.remove('active');
                if (navLink.getAttribute('href') === `#${pageId}`) {
                    navLink.classList.add('active');
                }
            });
            
            // Scroll to top
            window.scrollTo(0, 0);
        }

        // Show overview by default
        showPage('overview');

        // Sidebar toggle for mobile
        document.getElementById('sidebarToggle').addEventListener('click', function() {
            document.getElementById('sidebar').classList.toggle('active');
        });

        // Allow Enter key to trigger test
        document.getElementById('ttlSeconds').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                document.getElementById('testBtn').click();
            }
        });

        document.getElementById('idempotencyKey').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                document.getElementById('testBtn').click();
            }
        });
    </script>
</body>
</html>
