<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Idempotency Service - API Documentation</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='0.9em' font-size='90'>üîí</text></svg>">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            line-height: 1.6;
            color: #333;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 12px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 40px;
            text-align: center;
        }

        header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
        }

        header p {
            font-size: 1.2rem;
            opacity: 0.9;
        }

        .content {
            padding: 40px;
        }

        .section {
            margin-bottom: 40px;
        }

        .section h2 {
            color: #667eea;
            font-size: 1.8rem;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid #e0e0e0;
        }

        .section h3 {
            color: #764ba2;
            font-size: 1.4rem;
            margin-top: 25px;
            margin-bottom: 15px;
        }

        .endpoint {
            background: #f8f9fa;
            border-left: 4px solid #667eea;
            padding: 20px;
            margin: 20px 0;
            border-radius: 4px;
        }

        .endpoint-header {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 15px;
        }

        .method {
            display: inline-block;
            padding: 5px 12px;
            border-radius: 4px;
            font-weight: bold;
            font-size: 0.85rem;
            letter-spacing: 0.5px;
        }

        .method.post {
            background: #28a745;
            color: white;
        }

        .method.get {
            background: #007bff;
            color: white;
        }

        .url {
            font-family: 'Courier New', monospace;
            font-size: 1.1rem;
            color: #333;
            font-weight: 500;
        }

        .auth-badge {
            background: #ffc107;
            color: #333;
            padding: 4px 10px;
            border-radius: 12px;
            font-size: 0.75rem;
            font-weight: bold;
            margin-left: auto;
        }

        .auth-badge.required {
            background: #dc3545;
            color: white;
        }

        .auth-badge.none {
            background: #28a745;
            color: white;
        }

        .description {
            margin: 15px 0;
            line-height: 1.8;
        }

        pre {
            background: #2d2d2d;
            color: #f8f8f2;
            padding: 20px;
            border-radius: 6px;
            overflow-x: auto;
            font-size: 0.9rem;
            line-height: 1.5;
        }

        code {
            font-family: 'Courier New', monospace;
        }

        .parameter-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            background: white;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            border-radius: 6px;
            overflow: hidden;
        }

        .parameter-table th,
        .parameter-table td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid #e0e0e0;
        }

        .parameter-table th {
            background: #667eea;
            color: white;
            font-weight: 600;
            text-transform: uppercase;
            font-size: 0.85rem;
            letter-spacing: 0.5px;
        }

        .parameter-table tr:last-child td {
            border-bottom: none;
        }

        .parameter-table tr:hover {
            background: #f8f9fa;
        }

        .badge {
            display: inline-block;
            padding: 3px 8px;
            border-radius: 3px;
            font-size: 0.75rem;
            font-weight: bold;
            text-transform: uppercase;
        }

        .badge.required {
            background: #dc3545;
            color: white;
        }

        .badge.optional {
            background: #6c757d;
            color: white;
        }

        .response-code {
            display: inline-block;
            padding: 4px 8px;
            border-radius: 4px;
            font-family: monospace;
            font-weight: bold;
            margin-right: 10px;
        }

        .response-code.success {
            background: #d4edda;
            color: #155724;
        }

        .response-code.error {
            background: #f8d7da;
            color: #721c24;
        }

        .info-box {
            background: #e7f3ff;
            border-left: 4px solid #2196F3;
            padding: 15px;
            margin: 20px 0;
            border-radius: 4px;
        }

        .warning-box {
            background: #fff3cd;
            border-left: 4px solid #ffc107;
            padding: 15px;
            margin: 20px 0;
            border-radius: 4px;
        }

        .success-box {
            background: #d4edda;
            border-left: 4px solid #28a745;
            padding: 15px;
            margin: 20px 0;
            border-radius: 4px;
        }

        footer {
            background: #2d2d2d;
            color: white;
            padding: 20px;
            text-align: center;
            font-size: 0.9rem;
        }

        footer a {
            color: #667eea;
            text-decoration: none;
        }

        footer a:hover {
            text-decoration: underline;
        }

        .nav-links {
            display: flex;
            gap: 10px;
            margin-top: 20px;
            justify-content: center;
        }

        .nav-links a {
            background: rgba(255, 255, 255, 0.2);
            color: white;
            padding: 8px 16px;
            border-radius: 4px;
            text-decoration: none;
            transition: background 0.3s;
        }

        .nav-links a:hover {
            background: rgba(255, 255, 255, 0.3);
        }

        @media (max-width: 768px) {
            body {
                padding: 10px;
            }

            header h1 {
                font-size: 1.8rem;
            }

            .content {
                padding: 20px;
            }

            .endpoint-header {
                flex-direction: column;
                align-items: flex-start;
            }

            .auth-badge {
                margin-left: 0;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>üîí Idempotency Service</h1>
            <p>Never Process the Same Operation Twice</p>
            <div class="nav-links">
                <a href="#overview">Overview</a>
                <a href="#use-cases">Use Cases</a>
                <a href="#authentication">Authentication</a>
                <a href="#check-api">Check API</a>
                <a href="#health-api">Health API</a>
                <a href="#examples">Examples</a>
            </div>
        </header>

        <div class="content">
            <!-- Overview Section -->
            <section class="section" id="overview">
                <h2>üìñ Overview</h2>
                <p class="description">
                    The Idempotency Service is your safety net against duplicate operations. Whether due to network failures, 
                    user retries, or system crashes, duplicate requests can wreak havoc on your business. 
                    This service ensures that critical operations‚Äîlike payments, orders, and account updates‚Äîhappen exactly once, 
                    no matter how many times the request is sent within your configured time window.
                </p>
                
                <div class="info-box">
                    <strong>What You Get:</strong>
                    <ul style="margin-left: 20px; margin-top: 10px;">
                        <li>‚úÖ Zero duplicate charges or transactions</li>
                        <li>‚úÖ Reliable operation execution with automatic retry handling</li>
                        <li>‚úÖ Configurable memory duration‚Äîremember operations for as long as you need (default: 1 hour)</li>
                        <li>‚úÖ Perfect for payment systems, order processing, and automation workflows</li>
                        <li>‚úÖ Enterprise-grade security with API Key authentication</li>
                        <li>‚úÖ Simple integration‚Äîjust call our API before processing</li>
                    </ul>
                </div>

                <div class="warning-box">
                    <strong>‚è±Ô∏è Important to Know:</strong> We remember processed operations for a configurable time window (TTL). 
                    After this window expires, the same operation key can be processed again. 
                    Set your TTL based on your expected retry window‚Äîlonger for systems with slower retries, shorter for real-time systems.
                </div>

                <h3>Base URL</h3>
                <pre><code>http://144.24.119.46:8080/idempotency</code></pre>
            </section>

            <!-- Use Cases Section -->
            <section class="section" id="use-cases">
                <h2>üéØ Use Cases</h2>
                <p class="description">
                    The Idempotency Service helps you build reliable, fault-tolerant applications by preventing duplicate operations. 
                    The core idea is simple: <strong>before processing any critical operation, register its unique ID with our service</strong>. 
                    If the same ID comes again (due to retries, network issues, or user error), we tell you it's already been processed.
                </p>

                <div class="warning-box" style="background: #e8f4fd; border-left-color: #2196F3;">
                    <strong>üîë How It Works:</strong>
                    <ol style="margin-left: 20px; margin-top: 10px;">
                        <li>Your system receives a request with a unique identifier (Payment ID, Order ID, Zap ID, etc.)</li>
                        <li>Before processing, call our <code>/check</code> API with this ID as the idempotency key</li>
                        <li>If <code>isDuplicate: false</code> ‚Üí This is the first time. Proceed with processing.</li>
                        <li>If <code>isDuplicate: true</code> ‚Üí Already processed before. Skip and return cached/previous result.</li>
                    </ol>
                </div>

                <div class="endpoint" style="border-left-color: #28a745;">
                    <h3 style="color: #28a745; margin-top: 0;">üí≥ Payment Processing - Avoid Double Charges</h3>
                    <p class="description">
                        <strong>Scenario:</strong> Your payment gateway sends you a <code>payment_id: "pay_abc123"</code>. 
                        Due to network timeout, the gateway retries and sends the same payment notification again.
                    </p>
                    <p class="description">
                        <strong>Without Idempotency:</strong> You charge the customer twice for the same payment.
                    </p>
                    <p class="description">
                        <strong>With Idempotency:</strong> Before processing, check if <code>pay_abc123</code> was already processed. 
                        On retry, our service returns <code>isDuplicate: true</code> ‚Äî you skip the duplicate charge.
                    </p>
                    <pre style="margin-top: 15px;"><code>// First request
POST /idempotency/check {"idempotencyKey": "pay_abc123"} ‚Üí isDuplicate: false ‚úÖ Process payment

// Retry (same payment_id)
POST /idempotency/check {"idempotencyKey": "pay_abc123"} ‚Üí isDuplicate: true ‚è≠Ô∏è Skip, already done</code></pre>
                    <div class="success-box">
                        <strong>‚úÖ Result:</strong> Customer charged exactly once, regardless of how many times the request arrives.
                    </div>
                </div>

                <div class="endpoint" style="border-left-color: #007bff;">
                    <h3 style="color: #007bff; margin-top: 0;">üé´ Booking Systems - Prevent Double Reservations</h3>
                    <p class="description">
                        <strong>Scenario:</strong> A user clicks "Book Now" for a flight with <code>booking_ref: "BK-789"</code>. 
                        Slow network causes them to click again, or your system retries the failed request.
                    </p>
                    <p class="description">
                        <strong>Without Idempotency:</strong> User ends up with 2 seats booked and charged twice.
                    </p>
                    <p class="description">
                        <strong>With Idempotency:</strong> Register <code>BK-789</code> before creating the booking. 
                        Any duplicate attempt returns <code>isDuplicate: true</code> ‚Äî second booking is blocked.
                    </p>
                    <pre style="margin-top: 15px;"><code>// User clicks "Book"
POST /idempotency/check {"idempotencyKey": "BK-789"} ‚Üí isDuplicate: false ‚úÖ Create booking

// User clicks again (impatient)
POST /idempotency/check {"idempotencyKey": "BK-789"} ‚Üí isDuplicate: true ‚è≠Ô∏è Return existing booking</code></pre>
                    <div class="success-box">
                        <strong>‚úÖ Result:</strong> One seat reserved, one charge, happy customer.
                    </div>
                </div>

                <div class="endpoint" style="border-left-color: #fd7e14;">
                    <h3 style="color: #fd7e14; margin-top: 0;">‚ö° Zapier / Webhook Integration - Handle Retries Safely</h3>
                    <p class="description">
                        <strong>Scenario:</strong> You have a Zapier workflow that triggers on new orders. Zapier sends a 
                        <code>zap_id: "zap_event_456"</code> to your endpoint. Due to Zapier's retry policy, the same event is delivered 3 times.
                    </p>
                    <p class="description">
                        <strong>Without Idempotency:</strong> Your workflow runs 3 times ‚Äî 3 emails sent, 3 records created, chaos.
                    </p>
                    <p class="description">
                        <strong>With Idempotency:</strong> Use the <code>zap_id</code> as your idempotency key. Only the first delivery 
                        is processed; duplicates are automatically detected and skipped.
                    </p>
                    <pre style="margin-top: 15px;"><code>// Zapier sends event (1st delivery)
POST /idempotency/check {"idempotencyKey": "zap_event_456"} ‚Üí isDuplicate: false ‚úÖ Run workflow

// Zapier retries (2nd delivery)
POST /idempotency/check {"idempotencyKey": "zap_event_456"} ‚Üí isDuplicate: true ‚è≠Ô∏è Skip

// Zapier retries again (3rd delivery)
POST /idempotency/check {"idempotencyKey": "zap_event_456"} ‚Üí isDuplicate: true ‚è≠Ô∏è Skip</code></pre>
                    <div class="success-box">
                        <strong>‚úÖ Result:</strong> Workflow executes exactly once per unique Zap event.
                    </div>
                </div>

                <div class="endpoint" style="border-left-color: #20c997;">
                    <h3 style="color: #20c997; margin-top: 0;">üí∞ Zapier + E-Commerce: Duplicate Order Processing</h3>
                    <p class="description">
                        <strong>Scenario:</strong> Your Zapier workflow monitors your e-commerce platform for new orders. 
                        When an order is placed with <code>order_id: "order_12345"</code>, it's automatically sent to your fulfillment system. 
                        Network latency causes Zapier to retry the webhook delivery multiple times.
                    </p>
                    <p class="description">
                        <strong>Without Idempotency:</strong> Same order is sent to fulfillment multiple times ‚Äî customer receives duplicate packages, 
                        inventory is double-deducted, shipping costs increase unnecessarily.
                    </p>
                    <p class="description">
                        <strong>With Idempotency:</strong> Register <code>order_12345</code> as idempotency key before sending to fulfillment. 
                        Zapier retries are detected and skipped, ensuring each order is fulfilled exactly once.
                    </p>
                    <pre style="margin-top: 15px;"><code>// Zapier: New order detected
POST /idempotency/check {"idempotencyKey": "order-order_12345"} ‚Üí isDuplicate: false ‚úÖ Send to fulfillment

// Zapier webhook retry (network issue)
POST /idempotency/check {"idempotencyKey": "order-order_12345"} ‚Üí isDuplicate: true ‚è≠Ô∏è Skip fulfillment</code></pre>
                    <div class="success-box">
                        <strong>‚úÖ Result:</strong> One order fulfilled, inventory accurate, customer receives one package.
                    </div>
                </div>

                <div class="endpoint" style="border-left-color: #e83e8c;">
                    <h3 style="color: #e83e8c; margin-top: 0;">üí≥ Zapier + Payment Processing: Duplicate Payment Records</h3>
                    <p class="description">
                        <strong>Scenario:</strong> Zapier monitors your payment gateway for successful payment events. 
                        When a payment is completed with <code>payment_id: "pay_9876"</code>, it triggers a workflow 
                        to automatically record it in your accounting system.
                    </p>
                    <p class="description">
                        <strong>Without Idempotency:</strong> Same payment appears twice in your accounting records, 
                        skewing revenue reports and confusing your finance team.
                    </p>
                    <p class="description">
                        <strong>With Idempotency:</strong> Use payment ID as idempotency key. 
                        Even if Zapier retries multiple times, the payment record is created only once.
                    </p>
                    <pre style="margin-top: 15px;"><code>// Zapier: Payment succeeded
POST /idempotency/check {"idempotencyKey": "pay_9876"} ‚Üí isDuplicate: false ‚úÖ Create accounting record

// Zapier webhook retried due to timeout
POST /idempotency/check {"idempotencyKey": "pay_9876"} ‚Üí isDuplicate: true ‚è≠Ô∏è Skip</code></pre>
                    <div class="success-box">
                        <strong>‚úÖ Result:</strong> Accurate accounting records, clean revenue reports, no duplicates.
                    </div>
                </div>

                <div class="endpoint" style="border-left-color: #6c63ff;">
                    <h3 style="color: #6c63ff; margin-top: 0;">üë• Zapier + CRM: Duplicate Contact Syncing</h3>
                    <p class="description">
                        <strong>Scenario:</strong> Your Zapier workflow syncs new contacts from form submissions to your CRM system. 
                        Each submission comes with a unique <code>form_submission_id: "fsub_5678"</code>. 
                        Due to CRM API timeouts, Zapier retries the contact creation multiple times.
                    </p>
                    <p class="description">
                        <strong>Without Idempotency:</strong> Same contact is created multiple times in your CRM, 
                        creating duplicates that confuse your sales team and break follow-up workflows.
                    </p>
                    <p class="description">
                        <strong>With Idempotency:</strong> Register <code>fsub_5678</code> before creating the contact. 
                        Zapier retries detect the duplicate and skip contact creation, preventing CRM pollution.
                    </p>
                    <pre style="margin-top: 15px;"><code>// Zapier: New form submission
POST /idempotency/check {"idempotencyKey": "contact-fsub_5678"} ‚Üí isDuplicate: false ‚úÖ Create CRM contact

// Zapier retried due to CRM timeout
POST /idempotency/check {"idempotencyKey": "contact-fsub_5678"} ‚Üí isDuplicate: true ‚è≠Ô∏è Skip creation</code></pre>
                    <div class="success-box">
                        <strong>‚úÖ Result:</strong> Clean CRM database, no duplicates, accurate customer records.
                    </div>
                </div>

                <div class="endpoint" style="border-left-color: #ff6b6b;">
                    <h3 style="color: #ff6b6b; margin-top: 0;">üìß Zapier + Email Marketing: Duplicate Subscriber Addition</h3>
                    <p class="description">
                        <strong>Scenario:</strong> Zapier automatically adds new webinar registrants to your email marketing platform. 
                        Each registrant has a unique <code>registration_id: "reg_9876"</code>. 
                        When your registration system experiences a spike, Zapier queues the request and retries on failure.
                    </p>
                    <p class="description">
                        <strong>Without Idempotency:</strong> Same person gets added to your email list multiple times, 
                        receives duplicate welcome emails, and your unsubscribe rates spike due to spam perception.
                    </p>
                    <p class="description">
                        <strong>With Idempotency:</strong> Register <code>reg_9876</code> before adding to your email platform. 
                        Duplicate additions are detected and skipped, keeping your list clean.
                    </p>
                    <pre style="margin-top: 15px;"><code>// Zapier: New webinar registration
POST /idempotency/check {"idempotencyKey": "email-reg_9876"} ‚Üí isDuplicate: false ‚úÖ Add to email list

// Zapier retried after queue processing
POST /idempotency/check {"idempotencyKey": "email-reg_9876"} ‚Üí isDuplicate: true ‚è≠Ô∏è Skip email addition</code></pre>
                    <div class="success-box">
                        <strong>‚úÖ Result:</strong> Clean email lists, no duplicate subscribers, better engagement metrics.
                    </div>
                </div>

                <div class="endpoint" style="border-left-color: #13547a;">
                    <h3 style="color: #13547a; margin-top: 0;">üìä Zapier + Analytics: Duplicate Event Tracking</h3>
                    <p class="description">
                        <strong>Scenario:</strong> Zapier sends user behavior events from your app to your analytics platform. 
                        Each event has <code>event_id: "evt_analytics_2024"</code>. 
                        Network instability causes Zapier to retry event delivery multiple times.
                    </p>
                    <p class="description">
                        <strong>Without Idempotency:</strong> Same user action is recorded 3-5 times, 
                        inflating your analytics metrics and giving incorrect insights about user behavior.
                    </p>
                    <p class="description">
                        <strong>With Idempotency:</strong> Use event ID as idempotency key. 
                        Even if Zapier retries, each event is recorded only once in analytics.
                    </p>
                    <pre style="margin-top: 15px;"><code>// Zapier: User clicked "Download" button
POST /idempotency/check {"idempotencyKey": "analytics-evt_analytics_2024"} ‚Üí isDuplicate: false ‚úÖ Track event

// Zapier webhook retry
POST /idempotency/check {"idempotencyKey": "analytics-evt_analytics_2024"} ‚Üí isDuplicate: true ‚è≠Ô∏è Skip</code></pre>
                    <div class="success-box">
                        <strong>‚úÖ Result:</strong> Accurate analytics, reliable insights, correct user behavior data.
                    </div>
                </div>

                <div class="endpoint" style="border-left-color: #ff9f43;">
                    <h3 style="color: #ff9f43; margin-top: 0;">üè¶ Zapier + Accounting: Duplicate Invoice Creation</h3>
                    <p class="description">
                        <strong>Scenario:</strong> Zapier automatically creates invoices in your accounting system when customers make purchases. 
                        Each purchase has <code>transaction_ref: "txn_acc_001"</code>. 
                        Your accounting system API occasionally times out, causing Zapier to queue and retry the request.
                    </p>
                    <p class="description">
                        <strong>Without Idempotency:</strong> Same invoice is created multiple times, 
                        causing duplicate charges to customer, accounting mismatches, and audit issues.
                    </p>
                    <p class="description">
                        <strong>With Idempotency:</strong> Register transaction reference before creating invoice. 
                        Zapier retries detect it's already processed and skip invoice creation.
                    </p>
                    <pre style="margin-top: 15px;"><code>// Zapier: New purchase confirmed
POST /idempotency/check {"idempotencyKey": "invoice-txn_acc_001"} ‚Üí isDuplicate: false ‚úÖ Create invoice

// Zapier retried after timeout
POST /idempotency/check {"idempotencyKey": "invoice-txn_acc_001"} ‚Üí isDuplicate: true ‚è≠Ô∏è Skip</code></pre>
                    <div class="success-box">
                        <strong>‚úÖ Result:</strong> Accurate invoicing, correct accounting records, no duplicate charges.
                    </div>
                </div>

                <div class="endpoint" style="border-left-color: #6f42c1;">
                    <h3 style="color: #6f42c1; margin-top: 0;">üì¶ Order Processing - Stop Duplicate Orders</h3>
                    <p class="description">
                        <strong>Scenario:</strong> Your e-commerce platform generates <code>order_id: "ORD-2026-001234"</code> when a customer 
                        checks out. Network glitch causes the order submission to timeout and retry.
                    </p>
                    <p class="description">
                        <strong>Without Idempotency:</strong> Customer receives 2 identical orders and is charged twice.
                    </p>
                    <p class="description">
                        <strong>With Idempotency:</strong> Register the <code>order_id</code> before processing. 
                        Retries hit our service, see it's a duplicate, and the order is processed only once.
                    </p>
                    <pre style="margin-top: 15px;"><code>// Order submitted
POST /idempotency/check {"idempotencyKey": "ORD-2026-001234"} ‚Üí isDuplicate: false ‚úÖ Process order

// Network retry
POST /idempotency/check {"idempotencyKey": "ORD-2026-001234"} ‚Üí isDuplicate: true ‚è≠Ô∏è Return existing order</code></pre>
                    <div class="success-box">
                        <strong>‚úÖ Result:</strong> One order created, correct inventory, accurate billing.
                    </div>
                </div>

                <div class="endpoint" style="border-left-color: #17a2b8;">
                    <h3 style="color: #17a2b8; margin-top: 0;">üìß Notifications - No Spam to Customers</h3>
                    <p class="description">
                        <strong>Scenario:</strong> Your system sends order confirmation emails. The email job fails mid-way 
                        and is retried by your queue system with the same <code>notification_id: "notif_xyz"</code>.
                    </p>
                    <p class="description">
                        <strong>Without Idempotency:</strong> Customer gets the same email 5 times. They unsubscribe or report spam.
                    </p>
                    <p class="description">
                        <strong>With Idempotency:</strong> Before sending, check if <code>notif_xyz</code> was already sent. 
                        Duplicates are blocked at the source.
                    </p>
                    <pre style="margin-top: 15px;"><code>// First attempt
POST /idempotency/check {"idempotencyKey": "notif_xyz"} ‚Üí isDuplicate: false ‚úÖ Send email

// Queue retry
POST /idempotency/check {"idempotencyKey": "notif_xyz"} ‚Üí isDuplicate: true ‚è≠Ô∏è Email already sent, skip</code></pre>
                    <div class="success-box">
                        <strong>‚úÖ Result:</strong> Each notification sent exactly once. No customer complaints.
                    </div>
                </div>

                <div class="endpoint" style="border-left-color: #dc3545;">
                    <h3 style="color: #dc3545; margin-top: 0;">üîÑ API Retries on Transient Failures</h3>
                    <p class="description">
                        <strong>Scenario:</strong> Your service calls an external API to transfer funds with <code>transfer_id: "TXN-98765"</code>. 
                        The API succeeds but the response is lost due to a network drop. Your retry logic kicks in.
                    </p>
                    <p class="description">
                        <strong>Without Idempotency:</strong> Money is transferred twice because you didn't know the first attempt succeeded.
                    </p>
                    <p class="description">
                        <strong>With Idempotency:</strong> You registered <code>TXN-98765</code> before the transfer. 
                        On retry, you know it was already processed ‚Äî return success without re-transferring.
                    </p>
                    <pre style="margin-top: 15px;"><code>// Original request
POST /idempotency/check {"idempotencyKey": "TXN-98765"} ‚Üí isDuplicate: false ‚úÖ Transfer funds
// Transfer succeeds, but response lost...

// Automatic retry
POST /idempotency/check {"idempotencyKey": "TXN-98765"} ‚Üí isDuplicate: true ‚è≠Ô∏è Already done, return success</code></pre>
                    <div class="success-box">
                        <strong>‚úÖ Result:</strong> Safe retries. Money transferred exactly once.
                    </div>
                </div>

                <div class="info-box">
                    <strong>üí° Key Takeaway:</strong> Any unique identifier from your system or upstream services 
                    (Payment ID, Order ID, Zap ID, Transaction ID, Event ID, etc.) can be used as an idempotency key. 
                    Register it with our service <em>before</em> processing, and you're protected against duplicates forever (until TTL expires).
                </div>

                <div class="warning-box">
                    <strong>‚ö†Ô∏è Best Practice for Keys:</strong>
                    <ul style="margin-left: 20px; margin-top: 10px;">
                        <li><strong>Use existing IDs:</strong> Payment ID, Order ID, Zap ID, Transaction Reference ‚Äî don't generate new ones</li>
                        <li><strong>Be specific:</strong> Include operation type if the same ID is used for different actions (e.g., <code>charge-pay_123</code> vs <code>refund-pay_123</code>)</li>
                        <li><strong>Set appropriate TTL:</strong> Use <code>ttlSeconds</code> based on how long duplicates are possible (default: 1 hour)</li>
                    </ul>
                </div>
            </section>

            <!-- Authentication Section -->
            <section class="section" id="authentication">
                <h2>üîê Authentication</h2>
                <p class="description">
                    The <code>/check</code> endpoint requires API Key authentication. Include the API key in the request header.
                </p>

                <h3>How to Get an API Key</h3>
                <div class="success-box">
                    <strong>üìß Request API Key:</strong> To obtain an API key, please send a request email to:
                    <div style="margin-top: 10px; font-size: 1.1em; font-weight: bold;">
                        <a href="mailto:svmgarg@gmail.com?subject=API%20Key%20Request%20for%20Idempotency%20Service&body=Hi,%0A%0AI%20would%20like%20to%20request%20an%20API%20key%20for%20the%20Idempotency%20Service.%0A%0AThank%20you">
                            üìÆ svmgarg@gmail.com
                        </a>
                    </div>
                    <p style="margin-top: 15px; font-size: 0.95em;">
                        In your email, please mention:
                        <ul style="margin-left: 20px; margin-top: 10px;">
                            <li>Your name or organization</li>
                            <li>Use case for the API</li>
                            <li>Expected request volume</li>
                        </ul>
                    </p>
                </div>

                <h3>Header</h3>
                <table class="parameter-table">
                    <thead>
                        <tr>
                            <th>Header Name</th>
                            <th>Value</th>
                            <th>Required</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><code>X-API-KEY</code></td>
                            <td>Your assigned API key (provided by administrator)</td>
                            <td><span class="badge required">Required</span></td>
                        </tr>
                    </tbody>
                </table>

                <div class="warning-box">
                    <strong>‚ö†Ô∏è Important:</strong> The <code>/health</code> and <code>/ping</code> endpoints do not require authentication.
                </div>
            </section>

            <!-- Check API Section -->
            <section class="section" id="check-api">
                <h2>üîç Check API</h2>

                <div class="endpoint">
                    <div class="endpoint-header">
                        <span class="method post">POST</span>
                        <span class="url">/idempotency/check</span>
                        <span class="auth-badge required">üîê Auth Required</span>
                    </div>

                    <div class="description">
                        <p>
                            Atomically checks if an idempotency key exists and inserts it if not found or expired.
                            This endpoint always returns <code>200 OK</code> for successful checks (even for duplicates)
                            to support integrations like Zapier that treat non-2xx status codes as errors.
                        </p>
                    </div>

                    <h3>Request Body</h3>
                    <table class="parameter-table">
                        <thead>
                            <tr>
                                <th>Field</th>
                                <th>Type</th>
                                <th>Required</th>
                                <th>Description</th>
                                <th>Constraints</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><code>idempotencyKey</code></td>
                                <td>string</td>
                                <td><span class="badge required">Required</span></td>
                                <td>Unique key to identify the operation</td>
                                <td>Max 32 characters</td>
                            </tr>
                            <tr>
                                <td><code>clientId</code></td>
                                <td>string</td>
                                <td><span class="badge optional">Optional</span></td>
                                <td>Client identifier for multi-tenant scenarios</td>
                                <td>Max 128 characters</td>
                            </tr>
                            <tr>
                                <td><code>ttlSeconds</code></td>
                                <td>long</td>
                                <td><span class="badge optional">Optional</span></td>
                                <td>Custom TTL in seconds (overrides default 3600s)</td>
                                <td>Max 3600 seconds (1 hour)</td>
                            </tr>
                        </tbody>
                    </table>

                    <div class="warning-box">
                        <strong>‚ö†Ô∏è Validation Rules:</strong>
                        <ul style="margin-left: 20px; margin-top: 10px;">
                            <li><strong>idempotencyKey:</strong> Must be between 1-32 characters. Use meaningful, unique identifiers (Payment ID, Order ID, etc.)</li>
                            <li><strong>ttlSeconds:</strong> Maximum 3600 seconds (1 hour). Default is 3600s if not specified. This limits how long we remember processed operations.</li>
                            <li>If you need longer memory windows, contact support for enterprise plans.</li>
                        </ul>
                    </div>

                    <h3>Request Example</h3>
                    <pre><code>POST http://144.24.119.46:8080/idempotency/check
Content-Type: application/json
X-API-KEY: your-api-key-here

{
  "idempotencyKey": "payment-123-abc",
  "clientId": "client-A",
  "ttlSeconds": 3600
}</code></pre>

                    <h3>Response Body</h3>
                    <table class="parameter-table">
                        <thead>
                            <tr>
                                <th>Field</th>
                                <th>Type</th>
                                <th>Description</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><code>idempotencyKey</code></td>
                                <td>string</td>
                                <td>The idempotency key from the request</td>
                            </tr>
                            <tr>
                                <td><code>isDuplicate</code></td>
                                <td>boolean</td>
                                <td><code>false</code> = new key (proceed), <code>true</code> = duplicate (skip)</td>
                            </tr>
                            <tr>
                                <td><code>createdAt</code></td>
                                <td>timestamp</td>
                                <td>When the key was first created (ISO 8601 format)</td>
                            </tr>
                            <tr>
                                <td><code>expiresAt</code></td>
                                <td>timestamp</td>
                                <td>When the key will expire (ISO 8601 format)</td>
                            </tr>
                            <tr>
                                <td><code>processingTimeNanos</code></td>
                                <td>long</td>
                                <td>Processing time in nanoseconds</td>
                            </tr>
                        </tbody>
                    </table>

                    <h3>Response Examples</h3>
                    
                    <div class="success-box">
                        <strong>‚úÖ New Key (Proceed with Operation)</strong>
                    </div>
                    <pre><code>HTTP/1.1 200 OK
Content-Type: application/json

{
  "idempotencyKey": "payment-123-abc",
  "isDuplicate": false,
  "createdAt": "2026-02-03T16:30:00.123Z",
  "expiresAt": "2026-02-03T17:30:00.123Z",
  "processingTimeNanos": 12500
}</code></pre>

                    <div class="info-box">
                        <strong>‚ÑπÔ∏è Duplicate Key (Skip Operation)</strong>
                    </div>
                    <pre><code>HTTP/1.1 200 OK
Content-Type: application/json

{
  "idempotencyKey": "payment-123-abc",
  "isDuplicate": true,
  "createdAt": "2026-02-03T16:30:00.123Z",
  "expiresAt": "2026-02-03T17:30:00.123Z",
  "processingTimeNanos": 8200
}</code></pre>

                    <h3>Response Codes</h3>
                    <div style="margin: 20px 0;">
                        <p><span class="response-code success">200 OK</span> Check completed successfully (new or duplicate)</p>
                        <p><span class="response-code error">400 Bad Request</span> Invalid request body or validation error</p>
                        <p><span class="response-code error">401 Unauthorized</span> Missing or invalid API key</p>
                        <p><span class="response-code error">500 Internal Server Error</span> Server error occurred</p>
                    </div>

                    <div class="warning-box">
                        <strong>‚ö†Ô∏è Important Behavior:</strong>
                        <ul style="margin-left: 20px; margin-top: 10px;">
                            <li>Always returns <code>200 OK</code> for successful checks (even duplicates)</li>
                            <li>Check <code>isDuplicate</code> field to determine if operation should proceed</li>
                            <li>If <code>isDuplicate</code> is <code>false</code>, proceed with your operation</li>
                            <li>If <code>isDuplicate</code> is <code>true</code>, skip the operation (already processed)</li>
                            <li>Expired keys are automatically replaced with new entries</li>
                        </ul>
                    </div>
                </div>
            </section>

            <!-- Health API Section -->
            <section class="section" id="health-api">
                <h2>‚ù§Ô∏è Health & Monitoring APIs</h2>

                <div class="endpoint">
                    <div class="endpoint-header">
                        <span class="method get">GET</span>
                        <span class="url">/idempotency/health</span>
                        <span class="auth-badge none">üîì No Auth</span>
                    </div>

                    <div class="description">
                        <p>Health check endpoint that returns the operational status of the service.</p>
                    </div>

                    <h3>Request Example</h3>
                    <pre><code>GET http://144.24.119.46:8080/idempotency/health</code></pre>

                    <h3>Response Example</h3>
                    <pre><code>HTTP/1.1 200 OK
Content-Type: application/json

{
  "status": "UP",
  "service": "idempotency-service",
  "timestamp": "2026-02-03T16:30:00.123Z",
  "message": "Service is healthy and operational"
}</code></pre>
                </div>

                <div class="endpoint">
                    <div class="endpoint-header">
                        <span class="method get">GET</span>
                        <span class="url">/idempotency/ping</span>
                        <span class="auth-badge none">üîì No Auth</span>
                    </div>

                    <div class="description">
                        <p>Simple ping endpoint to verify service availability.</p>
                    </div>

                    <h3>Request Example</h3>
                    <pre><code>GET http://144.24.119.46:8080/idempotency/ping</code></pre>

                    <h3>Response Example</h3>
                    <pre><code>HTTP/1.1 200 OK
Content-Type: text/plain

pong</code></pre>
                </div>
            </section>

            <!-- Examples Section -->
            <section class="section" id="examples">
                <h2>üí° Usage Examples</h2>

                <h3>cURL Example</h3>
                <pre><code># Check idempotency (first request - new key)
curl -X POST http://144.24.119.46:8080/idempotency/check \
  -H "Content-Type: application/json" \
  -H "X-API-KEY: your-api-key" \
  -d '{
    "idempotencyKey": "payment-order-12345",
    "clientId": "user-abc",
    "ttlSeconds": 3600
  }'

# Response: {"isDuplicate": false, ...} - Proceed with operation

# Check same key again (duplicate)
curl -X POST http://144.24.119.46:8080/idempotency/check \
  -H "Content-Type: application/json" \
  -H "X-API-KEY: your-api-key" \
  -d '{
    "idempotencyKey": "payment-order-12345",
    "clientId": "user-abc"
  }'

# Response: {"isDuplicate": true, ...} - Skip operation</code></pre>

                <h3>JavaScript/Fetch Example</h3>
                <pre><code>async function checkIdempotency(key, clientId) {
  const response = await fetch('http://144.24.119.46:8080/idempotency/check', {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json',
      'X-API-KEY': 'your-api-key'
    },
    body: JSON.stringify({
      idempotencyKey: key,
      clientId: clientId,
      ttlSeconds: 3600
    })
  });

  const result = await response.json();
  
  if (result.isDuplicate) {
    console.log('Duplicate request - skipping operation');
    return false;
  } else {
    console.log('New request - proceeding with operation');
    return true;
  }
}</code></pre>

                <h3>Python Example</h3>
                <pre><code>import requests

def check_idempotency(key, client_id):
    response = requests.post(
        'http://144.24.119.46:8080/idempotency/check',
        headers={
            'Content-Type': 'application/json',
            'X-API-KEY': 'your-api-key'
        },
        json={
            'idempotencyKey': key,
            'clientId': client_id,
            'ttlSeconds': 3600
        }
    )
    
    result = response.json()
    
    if result['isDuplicate']:
        print('Duplicate request - skipping operation')
        return False
    else:
        print('New request - proceeding with operation')
        return True</code></pre>

                <h3>Integration Flow</h3>
                <div class="info-box">
                    <strong>Typical Integration Pattern:</strong>
                    <ol style="margin-left: 20px; margin-top: 10px;">
                        <li>Generate a unique idempotency key for your operation (e.g., UUID, transaction ID)</li>
                        <li>Call <code>POST /idempotency/check</code> with the key</li>
                        <li>Check the <code>isDuplicate</code> field in the response:
                            <ul style="margin-left: 20px;">
                                <li>If <code>false</code>: This is the first time seeing this key ‚Üí Proceed with your operation</li>
                                <li>If <code>true</code>: This key was already processed ‚Üí Skip the operation and return cached result</li>
                            </ul>
                        </li>
                        <li>The key will automatically expire after the TTL period</li>
                    </ol>
                </div>
            </section>

        </div>

        <footer>
            <p>¬© 2026 Idempotency Service | <a href="https://github.com/svmgarg/idempotent" target="_blank">GitHub Repository</a></p>
            <p style="margin-top: 10px; opacity: 0.8;">Built with Spring Boot ‚Ä¢ Version 1.0.0</p>
        </footer>
    </div>
</body>
</html>
